# DomainDrivenDesign
## 2022-05-01 Sun

## 소프트웨어 시스템의 구성
### 소프트웨어에 필수적인 사용자 인터페이스
* 사용자는 사용자 인터페이스를 통해 애플리케이션을 사용한다.
  * 즉, 애플리케이션이 소프트웨어로서 기능하려면 사용자 인터페이스가 필요하다.
  * 반면, 애플리케이션은 특정한 사용자 인터페이스에 의존하지 않아야 한다.
* 사용자 인터페이스는 크게 다음과 같이 분류할 수 있다.
  1. CLI: 사용자가 문자열 형식으로 지시를 내린다.
  2. GUI: 사용자가 그래픽을 통해 조작한다.
* 상술한 분류 중 어떠한 사용자 인터페이스를 사용하든지 도메인 주도 설계를 적용할 수 있다.

## 컨트롤러의 책임
```
> 컨트롤러의 책임은 입력을 변환하는 것이다.
```
* 게임기를 예로 들어, 플레이어는 컨트롤러의 버튼을 눌러 캐릭터를 움직인다.
  * 이 때 **컨트롤러는 버튼이 눌렸다는 정보를 그대로 게임기에 보내는 것이 아니라, 눌린 버튼에 맞추어 게임기가 이해할 수 있는 신호로 변환하여 전송**한다.
  * 즉, **게임기 컨트롤러의 역할은 플레이어의 입력을 게임기가 이해할 수 있는 형태로 변환하는 데에 있다**.
* **MVC 패턴의 컨트롤러 역시 같은 역할을 수행하며, 사용자의 입력을 모델이 요구하는 메시지로 변환하여 모델에 전달**한다.
  * 그 이상의 작업을 수행하는 컨트롤러가 있는 경우, 도메인 지식 또는 비즈니스 로직이 컨트롤러로 유출되었는지 확인해야 한다.

## 단위 테스트의 작성
* 소프트웨어를 완성하려면 의도대로 동작하는지 검증할 필요가 있으며, 이를 가장 쉽게 증명할 수 있는 도구는 단위 테스트이다.
  * 백문이 불여일견이라는 말도 있듯, 제대로 동작하는 이유를 백 번 말로 설명하는 것보다 직접 동작하는 모습을 한 번 보여주는 것이 훨씬 쉽다.
* **리포지토리를 사용하는 단위 테스트의 경우, 매 단위 테스트마다 테스트 데이터를 준비하는 방식은 현실적이지 못하다**.
* **단위 테스트에서는 일반적으로 실제 데이터 저장소에 접속하지 않으며, 이를 대신하기 위해 추상 리포지토리를 구현하는 테스트용 리포지토리를 사용**할 수 있다.
  * 이러한 테스트용 리포지토리로는 일반적으로 인메모리 리포지토리를 활용할 수 있다.
* 테스트 대상에 따라서는 리포지토리에 저장된 정보를 요청할 메소드가 없는 경우도 있을 수 있다.
  * 이 경우, 리포지토리에 정보를 요청하는 메소드를 굳이 만들기보다는 테스트용 리포지토리의 인메모리 데이터 저장소 역할을 맡는 변수를 public으로 공개한다.
  * 이렇듯 실제 데이터가 저장되는 속성을 외부에 공개하면 데이터에 대한 세세한 검색이 가능하므로 테스트 모듈의 편의성이 향상된다.
  * 일반적으로 필드를 외부에 공개하는 것은 삼가해야하지만, 테스트 코드에서만 사용하는 리포지토리 객체이므로 이 경우에는 문제가 되지 않는다.
* **우선 기능 별 정상 케이스를 작성하여 테스트하되, 테스트를 완료한 뒤에는 실패 케이스에 대한 테스트를 작성**한다.
  * 이상 케이스는 정상 케이스보다 검사할 항목이 많은 경우가 대부분이므로, 작성이 조금 더 복잡할 수 있다.
  * **정상 케이스와 함께 테스트한 경우에 경계값 검사의 모든 경우가 커버되는 테스트를 작성하는 것이 가장 이상적**이다.
* **단위 테스트는 어떠한 입력이 들어와야 하고, 입력에 대한 결과가 어떠해야하는지를 기술하는 요렁으로 작성**한다.
* **문서화가 전혀 되어 있지 않은 프로젝트의 경우, 단위 테스트가 로직의 설계와 동작을 드러내는 마지막 단서가 되는 경우도 있을 수 있다**.

## 결론
* 애플리케이션은 다양한 사용자 인터페이스를 적용하기 위해 교체를 지원해야 한다.
  * 사용자 인터페이스를 소프트웨어의 핵심과 분리하며, 객체의 책임을 명료히 나누는 것으로 소프트웨어의 미래가 더 밝아질 수 있다.
* **교환 가능한 사용자 인터페이스는 애플리케이션이 독립적으로 기능할 수 있으며, 단위 테스트를 수행할 수 있는 상태라는 의미를 갖는다**.
* 단위 테스트가 존재한다고 해서 무조건 소프트웨어의 품질이 향상된다고 볼 수는 없다.
  * 그러나 코드가 단위 테스트를 수행할 수 있는 상태에 이르는 것은 품질 향상의 첫걸음이기도 하다. 
* 소프트웨어가 요구사항의 변화에 대응할 수 있으려면 개발자가 리팩토링을 수행할 수 있어야 한다.
  * 이 경우, 단위 테스트가 적절히 갖추어져 있다면 리팩토링이 기존 동작을 유지하는 것을 확인하면서 리팩토링을 적용할 수 있다.
```
> 도메인의 변화를 도메인 객체에 잘 반영하고, 시스템이 도메인과 항상 동기화되기를 원한다면 단위 테스트를 잘 갖추어야 한다.
```