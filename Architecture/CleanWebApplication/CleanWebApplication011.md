# CleanWebApplication
## 2022-03-23 Wed

## 의식적인 지름길 사용
* 지름길을 방지하려면 지름길 자체를 우선 파악해야 하며, 정당한 지름길이라면 지름길을 사용함으로써 얻을 수 있는 효과를 의식적으로 선택할 수도 있다.

### 깨끗한 상태로 시작할 책임을 인지하기
* **우리는 모두 깨진 창문 효과에 영향을 받기 쉬우므로, 가능한 한 지름길을 사용하지 않고 기술 부채를 지지 않은 채로 프로젝트를 시작하는 것이 중요**하다.
  * 깨진 창문을 만들지도 말고, 생기지도 않도록 막는 것은 개발자 개개인의 막대한 책임이다.
  * **우리는 모두 미래의 우리, 또는 프로젝트 후임자에게 빚을 지고 있다**.
* 반면 프로토타이핑 등의 작업은 경제적인 이유에서 지름길을 사용하는 것이 실용적일 때도 있을 것이다.
  * 이러한 경우, 의도적인 지름길은 세심하게 기록하고 모두와 공유할 수 있도록 한다.

### 지름길 - 유즈케이스 간의 모델 공유
* 앞서 다룬 바와 같이, 유즈케이스마다 전용의 입출력 모델을 작성하는 것이 바람직하다.
  * 즉, **입력 매개 변수의 타입과 반환형의 타입은 달라야 한다**.
* **유즈케이스 간의 입출력 모델 공유는 유즈케이스 간의 결합으로 이어진다**.
* 공유되는 모델이 수정되는 경우, 결합된 모든 유즈케이스 역시 영향을 받는다.
  * 변경의 이유가 공유되는 것이므로, SRP를 위배하기 쉽다.
* **이러한 지름길은 유즈케이스들이 기능적으로 실제로 묶여있는 경우에 유효**하다.
  * 즉, **특정 요구사항을 공유하는 상황이며 세부사항을 변경하는 것은 두 유즈케이스 모두를 변경하려는 의도를 암시**한다.
* **반면, 유즈케이스들이 서로에게 미치는 영향 없이 독립적으로 진화해야하는 경우, 이러한 방식은 지름길이 되므로 지양**해야 한다.
  * 독립적으로 진화되어야 하는 유즈케이스들은 처음에는 같은 입출력 클래스를 복사해 사용했더라도, 명확히 분리해둔 채 시작해야 한다.
* 유사한 유즈케이스를 여럿 작성하는 경우, 유즈케이스를 독립적으로 유지보수해야 할지 끊임없이 자문해야 한다.
  * 그렇다고 판단되는 경우, 입출력 모델을 분리하도록 한다.

### 지름길 - 도메인 엔티티를 입출력 모델로 사용하는 경우
* 엔티티를 인커밍 포트의 입출력 모델로 사용하고 싶은 유혹에 빠지기 쉽지만, 유즈케이스가 복잡한 도메인 로직을 구현해야 한다면 반드시 분리해야 한다.
  * 즉, **유즈케이스 인터페이스에 대한 전용의 입출력 모델을 만들어 관리하고 엔티티를 사용하지 않도록 해야 한다**.
  * 이를 통해 유즈케이스의 변경이 도메인 엔티티에 전파되는 상황을 미연에 방지할 수 있다.
* 예를 들어 엔티티에 없는 정보를 유즈케이스가 필요로 하는 경우, 다른 도메인 또는 바운디드 컨텍스트가 아닌 엔티티에 새로운 필드를 추가하고 싶을 수 있다.
* **해당 지름길이 위험한 까닭은, 많은 유즈케이스가 간단한 생성 또는 업데이트로 시작되어 시간이 지남에 따라 복잡한 도메인 로직 괴물이 되기 때문**이다.
  * 이러한 특징은 최소 기능 제품에서 시작되어 점점 복잡도가 높아지는 애자일 환경에서 특히 두드러진다.
* 따라서, **처음에는 도메인 엔티티를 입력 모델로 사용했더라도 적절한 시기에 도메인 모델로부터 독립적인 전용 입력 모델로 교체해야 한다**. 

### 지름길 - 인커밍 포트 건너뛰기
* **아웃고잉 포트는 애플리케이션 계층과 아웃고잉 어댑터 사이의 의존성을 역전시키기 위한 필수적인 요소**이다.
  * 이를 통해 의존성은 안쪽을 향하게 할 수 있다.
* 반면, 인커밍 포트는 의존성을 역전시키기 위해 반드시 사용해야하는 필수적인 요소는 아니다.
  * 실제로 인커밍 포트 없이 애플리케이션 서비스에 직접 접근할 수 있다.
* 실제로 인커밍 포트를 제거하면 인커밍 어댑터와 애플리케이션 계층 사이의 추상화된 계층이 줄게 되고, 추상화 계층이 줄어드는 것을 일반적으로는 좋다.
* 그러나 **인커밍 포트는 애플리케이션의 중심에 접근하기 위해 사용하는 진입점을 명확히 정의하는 데에 의의**가 있다.
  * 인커밍 포트가 없다면 임의의 유즈케이스를 구현하기 위해 어떤 서비스 메소드를 호출해야만 하는지 알아내기 어렵다.
* 전용 인커밍 포트를 계속해서 유지해나간다면, 새로운 개발자의 코드 파악에 특히 도움이될 수 있다.
* **또한, 인커밍 포트를 유지하는 것으로 아키텍쳐를 쉽게 강제**할 수 있다.
  * 앞서 다룬 아키텍쳐를 강제하는 옵션들을 활용하는 것으로 인커밍 어댑터가 애플리케이션 서비스가 아닌 인커밍 포트만 호출할 수 있도록 강제할 수 있다.
  * 이 경우,** 애플리케이션 계층에 대한 진입점 정의는 아주 의식적인 결정이 된다**.
* **인커밍 포트를 유지할 수 있다면 인커밍 어댑터에서 실수로 다른 서비스 메소드를 호출할 가능성이 완전히 배제**될 수 있다.
* **애플리케이션의 규모가 작거나, 어댑터가 하나 뿐인 애플리케이션은 모든 제어 흐름을 인커밍 포트의 도움 없이도 파악할 수 있다**.
  * 그러나 언제나 애플리케이션의 규모가 확장되지 않는다는 점은 확신할 수 없다.

### 지름길 - 애플리케이션 서비스 건너뛰기
* 이러한 방법은 인커밍 어댑터와 아웃고잉 어댑터 사이의 모델 공유를 강제하게 된다.
  * 이 경우 **공유되는 모델은 도메인 엔티티이므로, 상술한 도메인 엔티티를 입력 모델로 사용하는 케이스의 단점을 그대로 수반**한다.
* 또한 애플리케이션 코어에 유즈케이스라고 할 만한 로직이 없어지게 된다.
  * 시간이 지나 프로젝트가 성숙해짐에 따라 CRUD 유즈케이스는 복잡해지지만, 도메인 로직은 별 수 없이 이미 유즈케이스를 갖는 아웃고잉 어댑터에 쌓아두게 된다.
  * 결과 **도메인 로직은 여기 저기에 흩어지며, 이후에 도메인 로직을 찾아내거나 유지보수하기는 더욱 어려워진다**.  
* 프로젝트 초기에서 단순한 전달 기능만을 수행하는 보일러플레이트로 구성된 서비스가 양산되는 것을 방지하기 위해 단순한 CRUD 케이스는 서비스를 생략할 수 있다.
  * 그러나 **유즈케이스가 단순한 CRUD 이상의 기능을 수행하게 되는 경우에는 반드시 애플리케이션 서비스를 정의한다는 명확한 가이드라인을 수립해두어야 한다**.

### 지름길과 유지보수 가능한 소프트웨어
* 경제적인 관점에서는 지름길이 합리적인 때도 있다.
  * 심지어 간단한 CRUD 만을 구현하는 유즈케이스에서는 전체 아키텍쳐를 구현하는 것이 과하게 느껴질 수도 있다.
* 그러나 **모든 애플리케이션은 처음에는 작게 시작하여 점점 복잡해지므로, 팀은 유즈케이스가 단순한 CRUD에서 벗어나는 시점을 명확하게 합의해야 한다**.
  * 팀은 합의를 이루고 나서야 지름길을 장기적으로 유지보수하기 좋은 아키텍쳐로 대체할 수 있게 된다.
* 물론 **단순한 CRUD 상태에서 벗어나지 않는 유즈케이스도 존재할 수 있으며, 이는 유지보수 비용을 증가시키지 않으므로 지름길을 계속 유지해도 무방**하다.
  * 심지어, 계속해서 지름길을 사용하는 것이 오히려 경제적이다!
* **어떠한 경우에서든, 어떠한 결정 사항이 되었든 아키텍쳐와 지름길에 관한 선택의 이유를 문서화하여 기록으로 남겨야 한다**.
  * 이를 통해 미래의 우리, 또는 추후 프로젝트를 인계 받을 개발자들이 앞선 모든 결정들을 평가할 수 있게 된다.