# Tdd
## 2022-08-09 Tue
## xUnit 살펴보기 
### 테스트 프레임워크의 기능
* 일반적인 테스트 프레임워크의 필수적인 기능은 크게 다음과 같다.
  1. 우선 setUp을 호출한다.
  2. 이후에 tearDown을 호출한다.
  3. 테스트 메소드가 실패하더라도 tearDown을 호출한다.
  4. 여러 개의 테스트를 실행할 수 있다.
  5. 수집된 결과를 출력할 수 있다.

### 일반화 리팩토링
* **일반적인 리팩토링의 패턴은 하나의 특화된 사례에만 동작하는 코드를 다른 사례에서도 적용할 수 있도록 일반화하는 것**이다.
  * 이 과정에서 상수를 변수로 변환하게 된다.
  * 또한, 상수는 반드시 데이터 값이 아닌 하드 코딩된 코드일 수도 있다.
* **이러한 리팩토링 방식은 단순히 머리 속 추론이 아닌, 잘 돌아가는 구체적인 사례로부터 시작할 수 있도록 지원한다는 점에서 TDD와 잘 맞는다**.

### TDD의 작업 단위
* TDD를 한 번 마스터하고 나면 예상보다 큰 기능 단위로 작업을 진행할 수 있다.
* 그러나, **TDD를 마스터하기 위해서는 반드시 필요할 때 아주 작은 단계로도 작업하는 방법을 배워야 한다**.
  * TDD에서 발생 가능한 최악의 경우는 큰 단계로 시작하여 실패하고, 다시 작은 단계로 돌아오는 것이다.

### 테스트 패턴
* 테스트 케이스를 작성해 나가다보면 이윽고 다음과 같은 공통된 패턴을 발견하게 된다.
  1. arrange: 객체를 생성하고 테스트를 준비한다.
  2. act: 객체에 어떤 자극을 주어 행동하게 한다.
  3. assert: 객체가 남긴 행동의 결과를 검사한다.
* **상술한 세 단계를 가리켜 3A라고도 부르며, 일반적으로 2.와 3.은 항상 다르지만 1.은 여러 테스트에 걸쳐 유사한 경우가 많다**.
* 이러한 패턴이 더 큰 규모에서 반복되는 경우, 테스트를 위해 객체를 준비하는 과정에서 다음과 같은 문제에 직면하게 된다.
  1. 성능: 테스트는 가능한 한 빨리 실행되어야 한다.
  2. 격리: 한 테스트의 결과가 다른 테스트에 영향을 주지는 않아야 한다.

### 테스트 디커플링
* 테스트 사이의 커플링은 다음과 같은 사례가 발생할 수 있으므로 지저분한 결과를 낳는다.
  1. 하나의 테스트가 깨져 다른 올바른 테스트들이 모두 깨질 가능성이 있다.
  2. 테스트가 실행되는 순서에 따라 결과가 달라질 가능성이 있다.
  3. 이에 따라, 하나의 테스트가 분명 잘못되었지만 실행 순서에 따라 테스트에 통과할 가능성이 있다.
* 이러한 이유에서 **테스트 케이스 간의 커플링은 지양해야하며, 서로 격리된 테스트 코드를 작성하는 것이 바람직**하다.

## 2022-08-10 Wed
### tearDown 메소드
* setUp 메소드에서 외부 자원을 할당 받는 경우, 테스트의 독립성 유지를 위해 자원을 다시 반환할 필요가 있다.
  * 이 때, 각 테스트 케이스 이후에 호출되는 **tearDown 메소드는 자원을 반환하기에 적절한 역할을 수행**한다.

### 리팩토링을 망설이지 않기
* 앞서 중복된 코드를 제거하는 과정에서 리팩토링한 것을 다시 되돌리는 것은 흔한 일이며, 이에 따른 개발자들의 대처는 크게 다음과 같다.
  1. 했던 일을 되돌리기 귀찮아서 중복이 서넛 발생할 때까지 기다린다.
  2. 또는 **작업 시간의 대부분을 설계에 할당하기 위해 반사적으로 리팩토링**한다.