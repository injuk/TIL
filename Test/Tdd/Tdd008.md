# Tdd
## 2022-08-14 Sun
### 자식 테스트로 리듬 유지하기
* 지나치게 큰 테스트를 통과시키기 어려운 경우, 테스트 케이스의 깨지는 부분에 해당하는 작은 테스트를 작성하고 이를 실행시킨다.
  * 그 후에 다시 원래의 테스트 케이스를 추가할 수 있다.
* **빨강 / 초록 / 리팩토링의 리듬은 성공을 지속시키는데 매우 중요하며, 그 리듬이 깨질 것 같은 순간에 부가적인 노력으로 리듬을 유지하는 것은 가치가 있다**.
* **너무 큰 테스트를 작성했다면 왜 테스트가 커졌으며 어떤 방식을 통해 작게 유지할 수 있었을지 교휸을 얻어내는 것이 바람직**하다.
  * 또한, 이를 수정하는 과정에서 기존 테스트를 삭제하거나 일단 실행되지 않도록 설정한 후에 작은 테스트를 작성하는 방법을 택할 수 있다.

### 모킹하기
* **비용이 많이 들거나 복잡한 리소스에 의존하는 객체를 테스트하는 경우, 상수를 반환하도록 만든 속임수 버전의 리소스를 새로 만들어 사용**한다.
  * 가장 대표적인 예시는 데이터베이스이며, 이는 시작이 오래 걸리고 깨끗한 상태로 유지하기도 어려우며 네트워크 상의 물리적인 위치에도 영향을 크게 받는다.
  * **이렇듯 데이터베이스는 개발 과정에서 발생하는 많은 오류의 원인이 되므로, 떠올릴 수 있는 해법은 실제 데이터베이스를 사용하지 않는 것**이다. 
  * **대부분의 테스트는 마치 데이터베이스인 것처럼 흉내내지만 실제로는 메모리에만 존재하는 객체를 통해 작성될 수 있다**.
  * 예를 들어, 모킹 데이터베이스 객체는 예상된 쿼리를 얻지 못하면 예외를 던지며 쿼리가 올바른 경우에만 result set처럼 보이는 결과를 반환한다.
* **모킹을 사용하도록 결정하는 가치는 성능과 견고함 이외에도 가독성**에 있다.
* **모의 객체 역시 큰 자원을 사용하므로, 이를 전역 변수에 저장해둔 채 방치하는 일이 발생하지 않도록 주의**해야 한다.
  * 부득이하게 전역 변수에 저장해야만하는 경우, 이를 모의 객체로 설정하고 테스트를 실행한 후에 다시 전역 변수를 복구시켜야 한다.
* **모의 객체는 모든 객체의 가시성에 대해 고민하도록 격려하므로, 설계에 불필요한 커플링을 방지**하도록 한다.
* 반면, 모의 객체를 도입하는 것은 프로젝트에 위험 요소를 하나 늘리는 것이기도 하다.
  * **모의 객체가 실제와 동일하게 동작하지 않을 수 있기 때문이며, 이는 모의 객체용 테스트 집합을 실제에도 그대로 적용해보는 것으로 위험을 줄일 수 있다**.