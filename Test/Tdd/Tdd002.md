# Tdd
## 2022-08-02 Tue

### TDD의 리듬
* 테스트 주도 개발의 리듬은 다음과 같이 요약할 수 있다.
  1. 빠르게 테스트를 하나 추가한다.
  2. 모든 테스트를 실행한 후, 새로 추가한 것이 실패하는지 확인한다.
  3. 코드를 조금 수정한다.
  4. 모든 테스트를 실행한 후, 전부 성공하는지 확인한다.
  5. 성공했다면, 리팩토링을 통해 중복을 제거한다.
* 테스트 주도 개발을 처음 시작하는 개발자는 다음과 같은 사실에 대해 놀랄 수 있지만, 이는 자연스러운 현상이다.
  1. 각각의 테스트가 기능 별 증가분을 커버한다.
  2. 새로운 테스트를 동작시키기 위해 작고 못생긴 변화를 실행한다.
  3. **너무나도 자주 테스트**한다.
  4. 수 없이 작은 단계를 통해 리팩토링해나간다.

### TODO 리스트 작성하기
* 임의의 기능을 프로젝트에 추가하는 경우, 우선 TODO 리스트를 작성하여 앞으로 어떤 일을 수행해야할지 정리한다.
  1. 리스트의 항목에 대해 작업을 시작한 경우, 굵은 글씨체로 표시한다.
  2. 작업을 완료한 경우, 취소선을 그어 표시한다.
  3. 작업 도중 새로운 할 일이 떠오른 경우, 리스트에 새로운 항목을 추가한다.
* **TODO 리스트를 작성했다면, 이제 객체를 만들기 전에 어떤 테스트를 작성할지 먼저 생각**해본다.
  * 만약 임의의 할 일이 너무 복잡해보인다면, 더 잘게 나누어 작은 것부터 시작하거나 아예 시작하지 않는다.

### 테스트 작성하기
* **테스트를 작성하기 시작할 때, 우선 객체가 수행할 수 있는 연산인 오퍼레이션의 완벽한 인터페이스에 대해 상상**한다.
  * 이렇게 상상된 API를 테스트 코드로 표현한 후에 시작한다.
* **최초의 테스트 코드는 완전할 필요가 없으며, 우선 실패하는 테스트를 만들고 최대한 빠르게 성공하는 것을 목표로 작은 단계로 시작**한다.
* 이렇게 작성하는 테스트 코드는 클래스의 메소드와 필드는 물론, 클래스 자체도 존재하지 않는 상태에서 작성하므로 컴파일조차 되지 않는다.
  * 이를 기본 생성자, 스텁 구현 메소드, 원시 타입 필드 등을 통해 최대한 빠르게 컴파일 가능하게 만든다.
  * 이 때, **스텁 구현이란 컴파일만될 수 있도록 만들어낸 메소드의 껍데기를 의미**한다.
* 테스트는 컴파일 가능해지더라도 실패하며, 실패한 테스트는 개발자를 주눅들게 할 수도 있다.
  * 그러나 **이는 실패의 구체적인 척도를 갖게된 것이며, 왜 실패하고 이를 통과시키기 위해 무엇을 해야할지 알 수 있게 되므로 큰 진척**으로 받아들여야 한다.
  * 또한, **이후에는 테스트 코드를 통과시키기 위해 완벽한 해법을 제시하기보다는 최대한 빠르게 통과하는 것을 목표로 하는 것이 바람직**하다.

### 첫 번째 테스트 성공
* **테스트가 성공하도록 코드를 구현하거나 수정한 것은 긍정적이나, 이에 안주하기보다는 다음과 같은 주기를 완성시키는데 집중하는 것이 바람직**하다.
  1. 작은 테스트를 추가한다.
  2. 모든 테스트를 실행하고, 테스트가 실패하는 것을 확인한다.
  3. 코드를 약간 수정한다.
  4. 모든 테스트를 실행하고, 테스트가 성공하는 것을 확인한다.
  5. 중복을 제거하기 위해 리팩토링한다.
* 또한, 이러한 주기 안에서 이루어지는 각 단계가 너무 작다고 해서 아쉬워하지 말아야 한다.
  * **TDD의 핵심은 작은 단계를 반드시 밟아야한다는 사실 자체가 아닌, 작은 단계를 밟을 줄 아는 능력을 가져야한다는 것**이다.
  * 정말 작은 단계로 구현하는 방법을 항상 연습해야 하며, 이를 토대로 저절로 적잘한 크기로 작업할 수 있는 소양을 기를 수 있게 된다.

### 첫 번째 테스트 성공 - 결론
* 이렇듯 간단한 테스트 주도 개발은 항상 다음과 같은 작업으로 시작된다.
  1. 현재까지 알고 있는 지식을 토대로 작업해야 할 테스트 목록을 만든다.
  2. **오퍼레이션이 외부에서 어떻게 보이기를 원하는지를 코드로 표현**한다.
  3. 끔찍한 코드를 작성하여 테스트를 통과시킨다.
  4. **돌아가기만 하는 코드를 점진적으로 일반화**한다.
  5. 새로운 할 일들을 즉시 처리하는 대신, TODO 리스트에 추가하고 넘어간다.