# Basics
## 2023-02-16 Thu
### 카프카 클러스터 운영 방식
* 카프카 클러스터를 직접 운영하는 경우, 다음과 같은 방식을 고려할 수 있다.
  1. 직접 서버에 설치한 후에 운영
  2. 또는 SaaS형 서비스를 도입
* 직접 서버에 설치하는 방식의 경우 설정을 세부적으로 최적화하여 최고의 성능으로 클러스터를 활용할 수 있으나, 운영자의 노하우가 지대한 영향을 미친다.
  * 반면, 컨플루언트 클라우드나 AWS MSK 등의 SaaS 서비스를 사용하는 경우 누구나 쉽고 빠르게 카프카 클러스터를 운영할 수 있다.
* 또한, 카프카는 다시 Apache가 제공하는 오픈소스 카프카와 컨플루언트가 제공하는 기업용 카프카로 분류될 수 있다.
  * 이 경우, 기업용 카프카는 커넥트 또는 모니터링 측면에서 이점이 있다.

### 카프카 클러스터 운영 시 하드웨어 권장 사양
* 컨플루언트의 경우, 상용 환경에서 카프카 클러스터를 운영하는 경우 다음과 같이 비교적 고성능의 브로커 서버 설정을 권장한다.
  1. 메모리: 32GB를 할당하되, 6GB는 힙 메모리로 설정하고 그 외는 OS의 페이지 캐시 용도로 사용
  2. CPU: 24코어를 할당하되, SSL과 같은 보안 설정을 사용하는 경우 더 높은 사양을 적용
  3. 디스크: RAID 10을 사용하는 디스크를 사용하되, NAS는 사용하지 않아야 함
  4. 파일 시스템: XFS 또는 ext4를 사용
* 특히, 페이지 캐시 영역의 메모리는 OS가 관리하며 프로듀서 또는 컨슈머 간의 상호작용시 힙 메모리 대신 사용하여 성능을 높이는 용도로 사용될 수 있다.
  * 이렇듯 대부분의 메모리 영역을 페이지 캐시 용도로 사용하므로, 실제 데이터 처리량은 더 높아지는 효과를 얻을 수 있다.
* 또한 카프카 클러스터에 포함되는 브로커의 개수는 개발 환경인 경우 5대, 운영 환경인 경우 10대가 권장된다. 
  * 그러나 앞서 다룬 바와 같이 카프카 클러스터에 포함된 브로커의 scale out은 쉬운 편에 속하므로, 정확히 몇 대를 유지할지에 대한 많은 고민은 필요가 없다.
* 나아가 디스크의 경우, 정확히 어느 정도의 용량을 권장하는지에 대한 기준은 없으므로 환경 및 실제 사용량에 따라 결정하는 것이 바람직하다.