# Basics
## 2022-07-17 Sun

### 단방향 연관 관계 매핑
* **JPA를 사용하는 개발자는 객체와 테이블 연관 관계의 차이를 이해하고, 객체의 참조와 테이블의 외래 키를 적절히 매핑할 수 있어야 한다**.
  * 예를 들어, 객체는 관계를 추적하기 위해 참조 연산자를 사용하지만 테이블은 FK를 사용한다.
  * 이렇듯 객체지향과 관계형 데이터베이스 사이에서 오는 불일치성을 해결하기 위해 연관 관계의 차이를 이해할 수 있어야 한다.
* 연관 관계는 말 그대로 두 엔티티 사이의 관계를 가리키며, 다음과 같은 항목들을 갖는다.
  1. 방향: 연관 관계는 단방향이거나 양방향일 수 있다.
  2. 다중성: 두 엔티티의 관계는 1:1이거나 1:N, M:N일 수 있다.
  3. 연관 관계의 주인: **객체의 양방향 연관 관계에서는 관리를 위한 주인 개념이 필요**하다. 

### 연관 관계가 왜 필요한가?
* **객체 지향 설계의 목표는 자율적인 객체들의 협력 공동체를 만드는 것이며, 단일 객체 또는 단일 테이블로 요구 사항을 해결할 수는 없다**.
* 객체를 관계형 데이터베이스의 개념인 테이블에 맞추어 설계할 경우, 두 엔티티 사이의 연관 관계는 생기지 않는다.
  * 이 경우, 객체는 서로의 FK 정보만을 필드로 갖게 되므로 상호 작용을 위해서는 반드시 데이터베이스를 조회할 필요가 있다.
  * 즉, **객체 간 연관 관계를 의미하는 참조 연산자를 사용할 수 없으며 단순한 값인 FK 정보만을 필드로 갖게 된다**.
* 이렇듯 **객체를 테이블에 맞춘 데이터 중심의 모델링은 적절한 협력 관계를 만들 수 없다**. 
  * **테이블은 외래 키를 활용한 JOIN 쿼리로 원하는 결과를 요청하지만, 객체는 참조 연산자를 활용하는 큰 차이**가 있다.
  * 즉, 외래 키와 참조라는 커다란 패러다임의 차이가 존재한다.

### 단방향 연관 관계
* 단방향 연관 관계는 가장 기본적이며, 가장 중요한 연관 관계에 해당한다.
* 상술한 **단점을 해소하는 객체지향적인 모델링의 경우, 테이블의 FK는 그대로 둔 채 코드 상에서는 엔티티가 연관된 엔티티의 객체를 참조하는 것**이다.
  * 예를 들어, 팀이 여러 회원을 포함하는 관계의 경우 회원은 `Long teamId;`가 아닌 `Team team`을 갖는다.
  * 이를 통해 객체는 자신과 연관된 팀 엔티티를 참조 연산자를 통해 탐색할 수 있게 된다.
* 그러나 **JPA의 경우, 엔티티가 다른 엔티티 객체를 포함하는 경우 반드시 연관 관계에 대한 정보를 어노테이션으로 명시하도록 강제**한다.
  * 또한 **이러한 @ManyToOne 등의 어노테이션을 통해 연관 관계 정보를 명시한 후, @JoinColumn을 통해 테이블의 FK 정보도 함께 명시**해주어야 한다. 