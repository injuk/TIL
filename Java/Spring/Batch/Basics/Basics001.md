# Basics
## 2022-06-29 Wed

### 배치 처리란 무엇인가?
```
> 배치 처리란, 상호작용이나 중단 없이 유한한 양의 데이터를 처리하는 것이다.
```
* 개발자들이 만드는 대부분의 애플리케이션은 사용자와 상호작용한다.
* 반면, 배치 처리 애플리케이션은 전혀 다른 유형으로 동작한다.
  1. **상호작용 또는 중단 없이 정해진 양의 데이터를 처리**한다.
  2. **배치 처리가 한 번 시작되고 나면, 이후에는 아무런 추가 개입 없이 어떠한 형태로든 완료**된다.

### 배치가 직면하는 문제들
* 일반적인 웹 애플리케이션과 같은 GUI 기반의 문제는 개발자에게 익숙하며, 대부분은 사용자가 우리의 애플리케이션을 사용하는 경우에 고려해야하는 문제들이다.
* 그러나 배치 처리의 경우 GUI 기반 애플리케이션이 갖는 대부분의 문제가 통하지 않는다.
  * 예를 들어, 사용량 급증 문제는 배치 처리 시에 예측이 가능하므로 부하를 예측하고 그에 맞게 설계할 수 있다.
* 반면, **배치 처리에 관련된 문제는 일반적인 개발 과정에서 고려해야하는 문제에 더해 배치 처리의 특성이 섞이게 된다**.
* 모든 소프트웨어는 공통적으로 사용성, 유지보수성, 확장성, 보안 등의 속성을 가지며, 이는 배치 애플리케이션 역시 예외가 아니다.
  * 오히려, 배치 처리에서는 이러한 속성들이 다른 방향으로 나아간다.

### 배치 애플리케이션과 사용성
```
> 배치 애플리케이션의 사용성은 코드와 관련이 있다.
```
* 배치 애플리케이션에는 보기 좋은 GUI가 존재하지 않으므로, 사용성은 일반적인 경우와는 다른 의미를 갖는다.
* 오히려 **배치 애플리케이션의 사용성은 다음과 같이 오류 처리 또는 유지보수 등, 코드와 관련**되어 있다.
  1. 공통 컴포넌트를 쉽게 확장하여 새로운 기능을 추가할 수 있는가?
  2. 기존 컴포넌트를 변경하는 경우, 시스템 전체에 미치는 영향을 쉽게 인지할 수 있는 테스트 케이스가 마련되어 있는가?
  3. 작업이 실패한 경우, 디버그에 오랜 시간을 사용하지 않고도 문제의 원인을 파악할 수 있는가?

### 배치 애플리케이션과 확장성
```
> 배치 애플리케이션이 처리할 수 있어야하는 규모는 기존에 개발해왔던 웹 애플리케이션보다 몇 자리 수 이상 큰 경우가 대부분이다.
```
* 일반적인 웹 애플리케이션의 경우, 사실 하루에 그리 많은 사용자가 접속하지는 않는다.
* 반면, 기업이 매일 100만 건 이상의 트랜잭션을 처리하기 위해 배치 애플리케이션을 사용하는 것은 드문 일이 아니다.

### 배치 애플리케이션과 가용성
```
> 배치 애플리케이션은 다른 애플리케이션과 달리, 항상 실행되는 상태를 가질 필요가 없다.
```
* 일반적으로 배치 처리에는 특정한 약속이 정해져 있으며, 대부분의 기업은 필요한 시간에 적절한 리소스를 사용한다.
* 때문에 **배치 애플리케이션의 가용성은 필요한 시점에 즉시 배치 처리를 수행할 수 있고, 시간 안에 작업을 완료하여 다른 시스템에 영향을 주지 않는지 묻는다**.

### 배치 애플리케이션과 보안
```
> 배치 애플리케이션에서의 보안은 시스템을 해킹하는 침입자에 초점을 두지 않는다.
```
* 배치 처리에서의 보안은 민감한 데이터를 안전하게 저장하고, 개인 정보를 남기지 않는 것이다.
  * 일반적으로 배치 처리 대상 데이터는 이미 검증된 데이터이지만, 배치 애플리케이션 자체적인 데이터 유효성 검증 역시 보안의 일부이다.
* 또한, 외부 시스템으로 접근할 때 적절한 자격증명을 활용하고 있는지 역시 중요하다.

## 2022-07-01 Fri
### 스프링 배치의 사용 사례
* 스프링 배치 프레임워크의 일반적인 사용 사례는 크게 다음과 같다.
  1. ETL: 데이터를 한 형식으로부터 다른 형식으로 변환하는 작업은 데이터 처리의 많은 부분을 차지하는 작업이다.
  2. 데이터 마이그레이션: 스프링 배치는 간단한 작업을 정의하는데 많은 코드가 필요하지 않으며, 커밋 횟수 측정 또는 롤백 기능 등을 제공한다.
  3. 병렬 처리: 스프링 배치는 멀티 코어 또는 멀티 서버에 처리를 손쉽게 분산하는 기능을 제공한다.
  4. 무중단 처리 또는 상시 데이터 처리: 스프링 배치를 통해 받아들인 데이터를 한 번에 처리할 수 있을만한 청크 단위로 모아 처리를 수행할 수 있다.

### 스프링 배치 프레임워크의 구조
* 스프링 배치는 다음과 같은 세 개의 티어로 조립되는 계층 구조를 갖는다.
  1. 애플리케이션 계층
  2. 코어 계층
  3. 인프라 계층
* 애플리케이션 계층은 가장 외부에 위치하며, 코어 계층과 인프라 계층을 감싸고 있다.
  * 해당 계층에는 업무 로직, 서비스, 잡 구조화를 위한 구성 등이 포함된다.
  * 또한, **애플리케이션 계층은 다음 계층인 코어 계층과 상호작용하는 데에 대부분의 시간을 소비**한다.
* 코어 계층은 배치 도메인을 정의하는 모든 부분이 포함되며, 잡 및 스텝, 그리고 잡 실행에 사용되는 인터페이스들이 포함된다.
* 인프라 계층은 가장 하위에 위치하며, 어떠한 처리를 위해 필요한 파일 및 데이터베이스 읽고 쓰기 작업을 지원한다.
* **흔히 알려진 오해와 달리, 스프링 배치는 프레임워크 내에 스케쥴링 기능을 포함하지 않는다**.
  * 스프링 배치로 작성된 애플리케이션을 스케쥴링하기 위해서는 쿼츠 등의 별도 스케쥴러를 활용해야 한다.

### 스프링 배치의 잡 구성 요소
* 잡은 중단 또는 상호작용 없이 처음부터 끝까지 실행되는 처리 단위를 말한다.
  * 이 때, 잡의 플로우는 조건부일 수 있다.
* 잡은 여러 개의 스텝이 모여 구성될 수 있다.
* 각각의 스텝에는 관련된 입력 또는 출력이 존재할 수 있다.
  * 스텝이 실패한 경우, 반복 실행을 할 수도 있고 못할 수도 있다.
* 태스크렛은 커스텀 컴포넌트이며, 스텝이 동작하는 동안에 수행될 비즈니스 로직을 정의한다.
  * 스프링 배치는 태스크렛이 완료될 때까지 execute 메소드를 반복해서 호출하며, 각 호출은 트랜잭션이 적용된다.
* 스프링 배치는 Java를 통해 상술한 개념들을 정의하는 클래스와 인터페이스, 유틸리티 등을 제공한다.

### 배치 아키텍쳐
* 상술했듯, 스프링 배치 프레임워크는 세가지 계층으로 구분된다.
  1. 애플리케이션: 개발자가 개발한 코드를 나타낸다.
  2. 코어: 배치 영역을 구성하는 실제적인 여러 컴포넌트로 구성된다.
  3. 인프라: ItemReader 및 ItemWriter, 그리고 재시작과 관련된 문제를 위한 클래스와 인터페이스가 제공된다.
* 이 중, **코어 레이어의 대표적인 컴포넌트로는 잡과 스텝**이 있다.