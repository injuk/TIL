# Spring MVC II
## 2024-07-26 Fri
### 공통 관심사와 서블릿 필터, 스프링 인터셉터
```
> 대표적인 두 기능인 필터와 인터셉터는 각각 서블릿과 스프링이 제공하는 기능이라는 점에서 차이가 있다.
```
* 예를 들어, 로그인된 사용자에 제한해야 하는 기능들이 많은 경우 각 기능을 대표하는 메소드마다 로그인 여부를 확인하는 로직이 포함되게 된다.
  * 나아가 이러한 로그인 여부를 확인하는 로직은 이후에 추가될 모든 기능에 대해서도 동일하게, 반복적으로 작성되어야 하는 경향이 있다.
* 이렇듯 **애플리케이션의 여러 로직에서 공통적으로 관심을 유지해야 할 기능을 `공통 관심사`라는 용어로 지칭하며, 인증은 대표적인 공통 관심사에 해당**한다.
* 이러한 **공통 관심사는 스프링이 제공하는 AOP로도 해결할 수 있으나, 그 중에서도 웹과 관련된 공통 관심사는 필터나 인터셉터를 활용하는 것이 바람직**하다.
  * 이는 **필터와 인터셉터가 모두 `HttpServletRequest`를 제공하므로, 헤더나 URL 등 사용자의 요청 정보에 더 쉽게 접근할 수 있기 때문**이다.
  * 덧붙여 별도의 기능을 제공하지 않는 AOP와 달리, 필터나 인터셉터는 웹과 관련된 수많은 부가 기능을 제공한다.

## 2024-07-27 Sat
### 서블릿 필터란?
```
> 필터는 마치 스프링 빈처럼 서블릿 컨테이너에 의해 싱글톤 객체로 관리된다는 점에 유의해야 한다.
```
* 필터는 서블릿이 제공하는 수문장으로, 다음과 같은 요청 및 응답 흐름 속에서 일반적인 로직으로서 동작한다.
```
> 사용자 -> HTTP 요청 -> WAS -> 서블릿 필터 -> 서블릿 -> 컨트롤러 -> ... 
```
* 이렇듯 **필터를 적용할 경우 서블릿이 호출되기에 앞서 필터가 호출된 후에 서블릿이 호출**되며, 패턴을 명시하여 특정 엔드포인트에만 필터를 적용할 수도 있다.
  * 때문에 모든 HTTP 요청에 대해 로그를 남기는 등의 요구 사항에 대해서는 우선적으로 필터를 고려해볼 수 있다.
* 예를 들어 로그인 사용자에 대해서만 API 호출이 가능하도록 제한하고자 하는 경우에도 필터를 사용할 수 있으며, 이 경우 제한된 요청은 필터 차원에서 차단된다.
* **하나 이상의 필터를 활용하는 것으로 필터 체인을 구성할 수 있으며, 각 필터는 순차적으로 처리되므로 언제든지 중간 필터를 추가하거나 제거할 수 있다**.
* **필터는 다음과 같은 메소드를 제공하는 인터페이스로, 필터의 구현체를 등록하는 것으로 서블릿 컨테이너가 필터에 해당하는 싱글톤 객체를 생성한 후 관리**한다.
  1. `init()`: 필터를 초기화하는 메소드이며, 서블릿 컨테이너가 생성되는 시점에 호출된다.
  2. `doFilter()`: **임의의 HTTP 요청에 대해 호출되는 메소드로, 필터의 핵심적인 로직을 작성**한다.
  3. `destroy()`: 필터 종료 메소드로서, 서블릿 컨테이너가 종료될 때 호출된다.