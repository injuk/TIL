# Basics
## 2022-10-06 Thu

### 실행 계획이란?
* 대부분의 DBMS는 다음과 같은 주요한 목적을 갖고 설계된다.
  1. 많은 데이터를 안전하게 저장하고 관리한다.
  2. 사용자가 원하는 데이터를 빠르게 조회할 수 있도록 한다.
* 이를 위해서는 **옵티마이저가 사용자의 쿼리를 최적으로 처리할 수 있도록하는 쿼리 실행 계획을 수립할 수 있어야 한다**.
  * 그러나 옵티마이저는 외부 개입 없이 항상 최적의 실행 계획을 수립할 수 있는 것은 아니다.
  * 때문에 **DBMS 서버는 이를 DBA나 개발자가 보완할 수 있도록 옵티마이저가 수립한 실행 계획을 확인할 수 있도록 EXPLAIN 명령을 제공**한다.
* 이 때, MySQL 서버가 실행 계획에 가장 큰 영향을 주는 것은 통계 정보에 해당한다.

### 통계 정보란?
* DB가 수집하는 통계 정보는 크게 다음과 같이 분류된다.
  1. 테이블 및 인덱스에 대한 통계 정보: **테이블과 인덱스에 대한 개괄적인 정보를 의미하며, MySQL 5.7 버전까지는 해당 통계 정보에 의존**한다.
  2. 히스토그램 정보: **인덱스되지 않은 컬럼들에 대해서도 수집한 데이터 분포도를 저장한 것을 의미하며, 8.0 버전부터는 해당 정보도 함께 사용**한다.
* **5.7 버전까지는 테이블 컬럼의 값들이 실제로 어떻게 분포되어 있는지에 대한 정보를 수집하지 않으므로, 실행 계획의 정확도가 떨어지곤 했다**.
  * 이로 인해 8.0부터는 히스토그램 정보를 함께 수집한다.
* 이 때, **히스토그램이 도입되었다고 해서 8.0 버전 이후의 MySQL이 테이블 또는 인덱스의 통계 정보를 사용하지 않는 것은 아니다**.

### 테이블과 인덱스의 통계 정보
* **통계 정보가 잘못된 경우 전혀 엉뚱한 쿼리 실행 계획을 수립할 수 있으므로, 비용 기반 최적화에서 가장 중요한 것은 통계 정보**이다.
* **MySQL 역시 다른 DBMS와 마찬가지로 비용 기반의 최적화를 사용하지만, 다른 DBMS 보다 통계 정보의 휘발성이 높고 정확도는 떨어지는 단점이 존재**했다.
  * 때문에 MySQL은 쿼리 실행 계획을 수립하는 경우, 실제 테이블의 데이터를 일부분 분석하여 통계 정보를 보완하는 식으로 동작했다.
  * MySQL 5.6 버전 이후부터는 통계 정보의 정확성을 높일 수 있는 여러 방법이 도입되기 시작했으나, 여러 사용자는 이를 간과하고 기존 방식을 사용하곤 한다.