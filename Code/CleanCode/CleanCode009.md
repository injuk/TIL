# CleanCode
## 2022-02-02 Wed

## 동시성
* 동시성과 깔끔한 코드는 양립하기가 어렵다!
* 동시성은 결합(coupling)을 없애기 위해 고려할 수 있는 전략이다.
  * **정확히는 육하원칙에서 무엇과 언제를 분리하는 전략**이다.
* 단일 스레드 프로그램은 무엇과 언제가 밀접하지만, 이를 성공적으로 분리하면 애플리케이션의 구조와 효율이 극적으로 향상된다.

### 미신과 오해
* 동시성은 언제나 유익하지는 않지만, 반드시 필요한 상황이 존재한다.
* 그러나 동시성은 어려울 뿐더러, 다음과 같은 일반적인 오해가 쌓여 있다.
  1. 동시성은 항상 성능을 높인다?
     * 예를 들어, 대기 시간이 매우 길어 여러 스레드가 하나의 프로세스를 공유할 수 있는 경우라면 그렇다.
     * 또는 여러 프로세서가 동시에 처리할 독립된 계산이 많은 경우에도 그렇다.
     * 그러나 **두 가지 경우 모두 자주 발생하는 상황이 아니며, 때문에 동시성은 떄떄로 성능을 높인다고 봐야** 한다.
  2. 동시성의 구현과 설계는 관계가 없다?
     * 단일 스레드 시스템과 다중 스레드 시스템은 설계 자체가 크게 다르다.
     * 일반적으로, 무엇과 언제가 분리되면 시스템의 구조는 크게 달라진다.
* 반면 다음의 내용은 동시성과 관련하여 타당한 사실을 서술한다.
  1. 동시성은 다소 부하를 유발한다.
     * 성능 측면에서 추가적인 부하가 있으며, 추가적인 코드 작성도 필요하다.
  2. 동시성은 복잡하다.
     * 간단한 문제라도 동시성을 활용하면 어려워진다.
  3. 일반적으로 동시성 버그는 재현이 어렵다.
     * 때문에 실제 결함으로 간주되지 않고, 일회용 버그로 여겨 무시되는 경우가 많다.
  4. 동시성을 구현하려면 대부분 근본적인 설계 전략을 재고해야 한다.
* 동시성은 간단한 로직에서도 두 스레드가 같은 변수를 동시에 참조하는 경우가 발생하기 쉬워 문제가 발생한다.
  * 대부분의 경우 올바른 답을 내놓지만, 그렇다고 해도 잘못된 결과를 내는 일부의 경로는 문제가 된다.