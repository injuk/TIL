# Refactoring
## 2022-04-19 Tue

## 기능의 이동
* 앞서 다룬 리팩토링 기법은 프로그래밍 요소를 제거하거나 이름을 변경하는 기법이 대부분이었다.
* 여기에 더해 **임의의 요소를 다른 클래스나 모듈 등의 컨텍스트로 옮기는 일 역시 중요한 리팩토링 기법에 속한다**.

## 2022-04-20 Wed
### 함수 옮기기
* 좋은 소프트웨어 설계의 핵심은 모듈화의 정도를 나타내는 모듈성이다.
  * 모듈성이란 프로그램의 특정한 부분을 수정해야할 때 해당 기능과 관련이 있는 일부만 이해해도 되도록 하는 능력이다.
  * **모듈성을 높이려면 연관된 요소를 묶고, 요소 사이의 연결 관계를 쉽게 찾을 수 있도록 해야 한다**.
* 반면 프로그램을 점점 이해해 감에 따라 소프트웨어 요소들을 더 잘 묶는 방법을 깨우치게 되며, 이 경우에는 높아진 이해를 반영할 수 있도록 요소를 옮겨야 한다.
* 모든 함수는 컨텍스트 안에 존재하며, 대부분은 특정한 모듈에 속한다.
  * **함수를 옮길지 말지 정하기 위해 대상 함수의 현재 컨텍스트와 후보 컨텍스트를 둘러볼 수 있다**.
* 함수의 최적 장소를 결정하기는 어려울 수 있으나, 선택이 어려울수록 큰 문제가 아닌 경우가 많다.

### 함수 옮기기 - 절차
1. 선택한 함수가 현재 컨텍스트에서 사용 중인 모든 프로그램 요소를 확인하고, 함께 옮겨야 할 요소가 있는지 고민한다.
   * 호출되는 함수 중 함께 옮길 것이 있다면 해당 함수를 먼저 옮기는 것이 일반적으로 좋다.
   * 얽힌 함수가 여럿이라면 다른 곳에 미치는 영향이 적은 함수부터 옮기는 것이 바람직하다.
2. 선택한 함수가 다형 메소드인지 확인한다.
   * 이렇듯 객체 지향 언어에서는 같은 메소드가 슈퍼클래스나 서브클래스에도 선언되어 있는지 고려해야 한다.
3. 선택한 함수를 대상 컨텍스트로 복사하고, 잘 자리잡도록 다듬어준다.
   * **함수 본문에서 원본 컨텍스트의 요소를 사용한다면 해당 요소는 매개변수 처리하거나, 원본 컨텍스트 자체를 참조로 넘겨준다**.
   * 함수를 옮기는 경우, 대상 컨텍스트에 맞는 명명이 필요한 경우가 있을 수 있음에 명심한다.
4. 정적 분석을 수행한다.
5. 원본 컨텍스트에서 대상 함수를 참조할 방법을 찾고, 코드에 반영한다.
6. 원본 함수를 대상 함수의 위임 함수가 되도록 수정한 후, 테스트를 진행한다.
7. 원본 함수를 인라인할지 고민한다.
   * 이 때, 원본 함수는 언제까지든지 위임 함수로 남겨둘 수 있다.
   * 그러나 **원본 함수를 호출하는 곳에서 대상 함수를 직접 호출하는 데에 무리가 없다면 중간 단계에 해당하는 원본 함수는 제거하는 것이 좋다**.