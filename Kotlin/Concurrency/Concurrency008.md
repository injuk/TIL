# Concurrency
## 2023-09-24 Sun
### 동시성 코드 작성의 어려움
* 동시성 코드를 작성하는 과정에서 가장 어려운 부분 중 하나는 버그를 발견하고, 이를 디버깅하는 데에 있다.
  * 이러한 버그들은 대부분 개발 과정의 후반부에 발견되곤 하며, 최악의 경우 운영 환경에서야 처음으로 발견될 수도 있다.
* 동시성과 관련된 대부분의 버그는 실제로 발생할 가능성이 없다고 생각하거나, 확률이 너무 낮은 케이스에서 발견되곤 한다.
  * 이 때, 이렇듯 발견이나 재현이 어려운 경우를 가리켜 엣지 케이스라고 지칭할 수 있다.

## 2023-09-25 Mon
### 동시성 테스트 코드 작성의 기본
* 동시성 테스트 코드를 작성할 경우, 다음과 같은 두 가지 원칙을 반드시 기억해두어야 한다.
  1. 가정을 버리기: 실제로는 **일어나지 않을 것 같은 상황이더라도, 적어도 테스트를 작성할 때만은 이를 고려하여 도전적으로 작성하는 것이 바람직**하다.
  2. 나무보다 숲을 보기: 여러 기본 단위를 검증하는 것도 좋지만, **동시성 테스트에서는 예상치 못한 상황 역시 모두 테스트하는 것이 바람직**하다.
* **상술한 원칙을 준수하기 위해서는 단위 테스트 뿐만 아니라 기능 테스트에도 집중하게 되며 각 기능 별 전체 동작을 테스트하는 코드를 작성**해야 한다.
  * 특히, 이러한 **기능 테스트는 각 기능을 전체적으로 실행하여 애플리케이션이 비동기 작업을 수행할 때 발생하는 복잡성을 테스트로 잘 표현**할 수 있다.
  * 바꿔 말해 기능 테스트를 작성하지 않은 동시성 애플리케이션은 취약점을 내포할 수 밖에 없으며, 코드를 수정할 때마다 원자성 위반 등의 현상이 발생하기 쉽다.